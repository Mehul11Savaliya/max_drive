<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
          <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
          <title>MaxDrive | Folder(<%=data.folder.name%>)</title>
          
          <!-- Favicon -->
      <link rel="shortcut icon" href="/assets/images/favicon.ico" />
          
          <link rel="stylesheet" href="/assets/css/backend-plugin.min.css">
          <link rel="stylesheet" href="/assets/css/backende209.css?v=1.0.0">
          
          <link rel="stylesheet" href="/assets/vendor/@fortawesome/fontawesome-free/css/all.min.css">
          <link rel="stylesheet" href="/assets/vendor/line-awesome/dist/line-awesome/css/line-awesome.min.css">
          <link rel="stylesheet" href="/assets/vendor/remixicon/fonts/remixicon.css">
          <link rel="stylesheet" href="/assets/vendor/fontawesome/main.css">
          
          <!-- Viewer Plugin -->
            <!--PDF-->
            <link rel="stylesheet" href="/assets/vendor/doc-viewer/include/pdf/pdf.viewer.css">
            <!--Docs-->
            <!--PPTX-->
            <link rel="stylesheet" href="/assets/vendor/doc-viewer/include/PPTXjs/css/pptxjs.css">
            <link rel="stylesheet" href="/assets/vendor/doc-viewer/include/PPTXjs/css/nv.d3.min.css">
            <!--All Spreadsheet -->
            <link rel="stylesheet" href="/assets/vendor/doc-viewer/include/SheetJS/handsontable.full.min.css">
            <!--Image viewer-->
            <link rel="stylesheet" href="/assets/vendor/doc-viewer/include/verySimpleImageViewer/css/jquery.verySimpleImageViewer.css">
            <!--officeToHtml-->
            <link rel="stylesheet" href="/assets/vendor/doc-viewer/include/officeToHtml/officeToHtml.css"> 
        <link rel="stylesheet" href="path/to/font-awesome/css/font-awesome.min.css">
        <link rel="stylesheet" href="/assets/vendor/fontawesome/css/fontawesome.min.css">
        <link rel="stylesheet" href="/assets/vendor/fontawesome/css/solid.css"> 
        <!-- new vander -->
        <link  rel="stylesheet" href="/assets/vendor/tokenfieldjs/tokenfield.css">
        <script  src="/assets/vendor/tokenfieldjs/tokenfield.web.js"></script>
        <link rel="stylesheet" href="/assets/vendor/timeline-slider/jquery.roadmap.min.css">
        <!-- new vander -->
    </head>
  <body class=" color-light ">
    <!-- loader Start -->
    <div id="loading">
          <div id="loading-center">
          </div>
    </div>
    <!-- loader END -->
    <script>
        var folder_page=true;
        var folder_id='<%-data.folder.id-%>';
        var folder_name = '<%-data.folder.name-%>';
        var folder_pass = '<%-data.folder.password-%>';
    </script>
    <!-- Wrapper Start -->
    <div class="wrapper">
      <%-include('components/sidebar.ejs',{}) -%>
           <div class="iq-top-navbar">
            <%-include('components/header.ejs',{}) -%>
        </div>
      </div>
      <div class="content-page">
        <div class="container-fluid">
            <div class="row">
                <input type="hidden" id="folder" value="true">
                <div class="col-lg-12">
                    <div class="d-flex align-items-center justify-content-between welcome-content mb-3">
                        <div class="navbar-breadcrumb">
                            <nav aria-label="breadcrumb">
                                <ul class="breadcrumb mb-0">
                                    <li class="breadcrumb-item"><a href="/user/">My Drive</a></li>
                                    <li contenteditable="true" style="border: 1px solid black;border-radius: 3px;" id="fname" class="breadcrumb-item active" aria-current="page"><%=data.folder.name%></li>
                                </ul>
                            </nav>
                        </div>
                        <div class="d-flex align-items-center">
                            <div class="list-grid-toggle mr-4">
                                <span class="icon icon-grid i-grid"><i class="fa-solid fa-folder font-size-20"></i></span>
                                <span class="icon icon-grid i-list"><i class="fa-solid fa-list font-size-20"></i></span>
                                <span class="label label-list">List</span>
                            </div>
                            <div class="mr-4 align-items-center">
                                <a onclick="folder_gen_timeline('<%-data.folder.id-%>')" data-toggle="tooltip" data-placement="up" title="Timeline" data-original-title="Timeline"><i class="fa-solid fa-code-branch"></i></a>
                            </div>
                            <div class="dashboard1-dropdown d-flex align-items-center">
                                <div class="dashboard1-info rounded">
                                    <a href="#calander" class="collapsed" data-toggle="collapse" aria-expanded="false">
                                        <i class="ri-arrow-down-s-line"></i>
                                    </a>
                                    <ul id="calander" class="iq-dropdown collapse list-inline m-0 p-0 mt-2">
                                        <li class="mb-2">
                                            <a onclick="upload_file()" data-toggle="tooltip" data-placement="right" title="Upload🐦" data-original-title="Upload🐦"><i class="fa-solid fa-upload"></i></a>
                                        </li>
                                        <li class="mb-2">
                                            <a onclick="folder_edit2('<%-data.folder.id-%>')" data-toggle="tooltip" data-placement="right" title="edit" data-original-title="edit"><i class="fa-solid fa-pen-to-square"></i></a>
                                        </li>
                                        <li>
                                            <a onclick="folder_edit('<%-data.folder.id-%>')" data-toggle="tooltip" data-placement="right" title="share" data-original-title="share"><i class="fa-solid fa-share"></i></a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="icon icon-grid i-grid">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="card card-block card-stretch card-transparent">
                            <div class="card-header d-flex justify-content-between pb-0">
                                <div class="header-title">
                                    <h4 class="card-title">Files</h4>
                                </div>
                            </div>
                        </div>
                    </div>
                    <section >
                        <div class="row" id="files"></div>
                    </section>
               
                    <div class="col-lg-12">
                        <div class="card card-block card-stretch card-transparent">
                            <div class="card-header d-flex justify-content-between pb-0">
                                <div class="header-title">
                                    <h4 class="card-title">Folders</h4>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-8 col-md-6 col-sm-6">
                    <input  id="tags" type="text" class="form form-control basic" placeholder="enter tags." name="tags" aria-label="tags" aria-describedby="enter tags." />
                </div>
            </div>
            <br>
            <div class="icon icon-grid i-list">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="card card-block card-stretch card-transparent">
                            <div class="card-header d-flex justify-content-between pb-0">
                                <div class="header-title">
                                    <h4 class="card-title">list View</h4>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-12">
                        <div class="card card-block card-stretch card-height">
                            <div class="card-body">
                                <div class="table-responsive" style="height: 70vh;overflow-y: scroll;">
                                    <table class="table mb-0 table-borderless tbl-server-info" >
                                        <thead>
                                            <tr>
                                                <th scope="col">Name</th>
                                                <th scope="col">Owner</th>
                                                <th scope="col">Last Edit</th>
                                                <th scope="col">File Size</th>
                                                <th scope="col"></th>
                                            </tr>
                                        </thead>
                                        <tbody id="rowsholder">
                                        </tbody>
                                    </table>
                                </div>
                              <script>
                                
                                let namei = document.querySelector("#fname");
                                var oldname = namei.textContent;
                                var name ="";
                                namei.addEventListener('click', () => {
            namei.setAttribute('contenteditable', 'true');
            namei.focus(); 
        });

        namei.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                e.preventDefault(); 
                if (namei.textContent==""||namei.textContent==null) {
                    name = oldname;
                }else{
                    name = namei.textContent;
                }
                namei.blur(); 
            }
        });

        namei.addEventListener('blur',async () => {
            namei.removeAttribute('contenteditable'); 
            await folder_update('<%-data.folder.id-%>',{name:name}); 
        });

                                var tags  ='<%-data.folder.tags-%>';
                                let old_tags  = tags.split(",").map((val)=>{
                                  return {
                                    isNew:true,
                                    name : val
                                  }
                                })
                               const myItems = []
                                const instance = new Tokenfield({
                                               el: document.querySelector('.basic'),
                                                items: myItems,
                                              setItems:old_tags
                                              });
                               instance.on("change",async ()=>{
                                let tags  = instance.getItems().map((val)=>{return val.name})
                                  try {
                                   await folder_update('<%-data.folder.id-%>',{tags:tags}); 
                                  } catch (error) {
                                  
                                  }
                               });
                               </script>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div  id="folder-timeline"></div>
               
              </div>
        </div>
      </div>
    </div>
    <!-- Wrapper End-->
    <%-include('components/footer.ejs',{}) -%>
    <!-- Backend Bundle JavaScript -->
    <script src="/assets/js/backend-bundle.min.js"></script>
    
    <!-- Chart Custom JavaScript -->
    <script src="/assets/js/customizer.js" defer></script>
    
    <!-- Chart Custom JavaScript -->
    <script src="/assets/js/chart-custom.js" defer></script>
    
    <!--PDF-->
    <script src="/assets/vendor/doc-viewer/include/pdf/pdf.js"></script>
    <!--Docs-->
    <script src="/assets/vendor/doc-viewer/include/docx/jszip-utils.js"></script>
    <script src="/assets/vendor/doc-viewer/include/docx/mammoth.browser.min.js"></script>
    <!--PPTX-->
    <script src="/assets/vendor/doc-viewer/include/PPTXjs/js/filereader.js"></script>
    <script src="/assets/vendor/doc-viewer/include/PPTXjs/js/d3.min.js"></script>
    <script src="/assets/vendor/doc-viewer/include/PPTXjs/js/nv.d3.min.js"></script>
    <script src="/assets/vendor/doc-viewer/include/PPTXjs/js/pptxjs.js"></script>
    <script src="/assets/vendor/doc-viewer/include/PPTXjs/js/divs2slides.js"></script>
    <!--All Spreadsheet -->
    <script src="/assets/vendor/doc-viewer/include/SheetJS/handsontable.full.min.js"></script>
    <script src="/assets/vendor/doc-viewer/include/SheetJS/xlsx.full.min.js"></script>
    <!--Image viewer-->
    <script src="/assets/vendor/doc-viewer/include/verySimpleImageViewer/js/jquery.verySimpleImageViewer.js"></script>
    <!--officeToHtml-->
    <script src="/assets/vendor/doc-viewer/include/officeToHtml/officeToHtml.js"></script>
    <!-- app JavaScript -->
    <script src="/assets/js/app.js" defer></script>
    <script src="/assets/js/doc-viewer.js" defer></script>

    <!-- new vadonr -->
    <script src="/assets/vendor/timeline-slider/jquery.roadmap.min.js"></script>
    <script src="/assets/vendor/socketio/socket.io.min.js"></script>
    <!-- new vandor -->

    <script src="/assets/vendor/bootstrap/bootstrap.min.js"></script>
     <!-- Modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title">Title</h4>
                    <div>
                        <a class="btn" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </a>
                    </div>
                </div>
                <div class="modal-body">
                    <div id="resolte-contaniner" style="height: 500px;" class="overflow-auto">
                        File not found
                    </div>
                </div>
            </div>
        </div>
    </div>
  </body>
</html>